I"Iğ<ul id="markdown-toc">
  <li><a href="#1-è¯­è¨€æ–°ç‰¹æ€§" id="markdown-toc-1-è¯­è¨€æ–°ç‰¹æ€§"><code class="highlighter-rouge">1</code> è¯­è¨€æ–°ç‰¹æ€§</a>    <ul>
      <li><a href="#11-lambda" id="markdown-toc-11-lambda"><code class="highlighter-rouge">1.1</code> Lambda</a></li>
      <li><a href="#12-functionalinterface" id="markdown-toc-12-functionalinterface"><code class="highlighter-rouge">1.2</code> FunctionalInterface</a></li>
      <li><a href="#13-æ¥å£é»˜è®¤æ–¹æ³•" id="markdown-toc-13-æ¥å£é»˜è®¤æ–¹æ³•"><code class="highlighter-rouge">1.3</code> æ¥å£é»˜è®¤æ–¹æ³•</a></li>
      <li><a href="#14-æ¥å£é™æ€æ–¹æ³•" id="markdown-toc-14-æ¥å£é™æ€æ–¹æ³•"><code class="highlighter-rouge">1.4</code> æ¥å£é™æ€æ–¹æ³•</a></li>
      <li><a href="#15-æ–¹æ³•å¼•ç”¨" id="markdown-toc-15-æ–¹æ³•å¼•ç”¨"><code class="highlighter-rouge">1.5</code> æ–¹æ³•å¼•ç”¨</a></li>
      <li><a href="#16-é‡å¤æ³¨è§£" id="markdown-toc-16-é‡å¤æ³¨è§£"><code class="highlighter-rouge">1.6</code> é‡å¤æ³¨è§£</a></li>
      <li><a href="#17-ç±»å‹æ¨æµ‹" id="markdown-toc-17-ç±»å‹æ¨æµ‹"><code class="highlighter-rouge">1.7</code> ç±»å‹æ¨æµ‹</a></li>
      <li><a href="#18-æ‰©å±•æ³¨è§£" id="markdown-toc-18-æ‰©å±•æ³¨è§£"><code class="highlighter-rouge">1.8</code> æ‰©å±•æ³¨è§£</a></li>
    </ul>
  </li>
  <li><a href="#2-ç±»åº“æ–°ç‰¹æ€§" id="markdown-toc-2-ç±»åº“æ–°ç‰¹æ€§"><code class="highlighter-rouge">2</code> ç±»åº“æ–°ç‰¹æ€§</a>    <ul>
      <li><a href="#21-optional" id="markdown-toc-21-optional"><code class="highlighter-rouge">2.1</code> Optional</a></li>
      <li><a href="#22-stream" id="markdown-toc-22-stream"><code class="highlighter-rouge">2.2</code> Stream</a></li>
      <li><a href="#23-datetime-api" id="markdown-toc-23-datetime-api"><code class="highlighter-rouge">2.3</code> Date/Time API</a></li>
      <li><a href="#24-nashorn" id="markdown-toc-24-nashorn"><code class="highlighter-rouge">2.4</code> Nashorn</a></li>
      <li><a href="#25-base64" id="markdown-toc-25-base64"><code class="highlighter-rouge">2.5</code> Base64</a></li>
      <li><a href="#26-å¹¶è¡Œparallel-æ•°ç»„" id="markdown-toc-26-å¹¶è¡Œparallel-æ•°ç»„"><code class="highlighter-rouge">2.6</code> å¹¶è¡Œï¼ˆparallel ï¼‰æ•°ç»„</a></li>
      <li><a href="#27-å¹¶å‘concurrency" id="markdown-toc-27-å¹¶å‘concurrency"><code class="highlighter-rouge">2.7</code> å¹¶å‘ï¼ˆconcurrencyï¼‰</a></li>
    </ul>
  </li>
  <li><a href="#3-ç¼–è¯‘å™¨æ–°ç‰¹æ€§" id="markdown-toc-3-ç¼–è¯‘å™¨æ–°ç‰¹æ€§"><code class="highlighter-rouge">3</code> ç¼–è¯‘å™¨æ–°ç‰¹æ€§</a>    <ul>
      <li><a href="#31-å‚æ•°å" id="markdown-toc-31-å‚æ•°å"><code class="highlighter-rouge">3.1</code> å‚æ•°å</a></li>
    </ul>
  </li>
  <li><a href="#4-æ–°çš„javaå·¥å…·" id="markdown-toc-4-æ–°çš„javaå·¥å…·"><code class="highlighter-rouge">4</code> æ–°çš„Javaå·¥å…·</a>    <ul>
      <li><a href="#41-nashornå¼•æ“-jjs" id="markdown-toc-41-nashornå¼•æ“-jjs"><code class="highlighter-rouge">4.1</code> Nashornå¼•æ“ <code class="highlighter-rouge">jjs</code></a></li>
      <li><a href="#42-ç±»ä¾èµ–åˆ†æå™¨-jdeps" id="markdown-toc-42-ç±»ä¾èµ–åˆ†æå™¨-jdeps"><code class="highlighter-rouge">4.2</code> ç±»ä¾èµ–åˆ†æå™¨ <code class="highlighter-rouge">jdeps</code></a></li>
    </ul>
  </li>
  <li><a href="#5-jvmæ–°ç‰¹æ€§" id="markdown-toc-5-jvmæ–°ç‰¹æ€§"><code class="highlighter-rouge">5</code> JVMæ–°ç‰¹æ€§</a></li>
</ul>

<h1 id="1-è¯­è¨€æ–°ç‰¹æ€§"><code class="highlighter-rouge">1</code> è¯­è¨€æ–°ç‰¹æ€§</h1>

<h2 id="11-lambda"><code class="highlighter-rouge">1.1</code> Lambda</h2>

<p>è‡ªåŠ¨æ¨æµ‹å½¢å‚ç±»å‹<code class="highlighter-rouge">e</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span> <span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"d"</span> <span class="o">).</span><span class="na">forEach</span><span class="o">(</span> <span class="n">e</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="n">e</span> <span class="o">)</span> <span class="o">);</span>
</code></pre></div></div>
<p>æŒ‡å®šå½¢å‚ç±»å‹<code class="highlighter-rouge">e</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span> <span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"d"</span> <span class="o">).</span><span class="na">forEach</span><span class="o">(</span> <span class="o">(</span> <span class="nc">String</span> <span class="n">e</span> <span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="n">e</span> <span class="o">)</span> <span class="o">);</span>
</code></pre></div></div>
<p>æ–¹æ³•ä½“å¯ä»¥ç”¨<code class="highlighter-rouge">{}</code>åŒ…è£¹</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span> <span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"d"</span> <span class="o">).</span><span class="na">forEach</span><span class="o">(</span> <span class="n">e</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span> <span class="n">e</span> <span class="o">);</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span> <span class="n">e</span> <span class="o">);</span>
<span class="o">}</span> <span class="o">);</span>
</code></pre></div></div>

<p><strong>effectively final</strong>ï¼Œlambdaå¼•ç”¨çš„å¯¹è±¡ä¼šè‡ªåŠ¨è½¬ä¸ºfinal</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">separator</span> <span class="o">=</span> <span class="s">","</span><span class="o">;</span>
<span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span> <span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"d"</span> <span class="o">).</span><span class="na">forEach</span><span class="o">(</span> 
    <span class="o">(</span> <span class="nc">String</span> <span class="n">e</span> <span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span> <span class="n">e</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">)</span> <span class="o">);</span>
</code></pre></div></div>

<h2 id="12-functionalinterface"><code class="highlighter-rouge">1.2</code> FunctionalInterface</h2>

<p>å‡½æ•°æ¥å£å°±æ˜¯åªå…·æœ‰ä¸€ä¸ªæ–¹æ³•çš„æ™®é€šæ¥å£ï¼Œè¿™æ ·çš„æ¥å£ï¼Œå¯ä»¥è¢«éšå¼è½¬æ¢ä¸ºlambdaè¡¨è¾¾å¼ï¼Œ</p>

<p>ç„¶è€Œï¼Œä¸€æ—¦åœ¨æ­¤æ¥å£ä¸­å¢åŠ äº†æ–¹æ³•ï¼Œå®ƒå°†ä¸å†æ˜¯å‡½æ•°æ¥å£ï¼Œä½¿ç”¨lambdaæ—¶ä¹Ÿå°†ç¼–è¯‘å¤±è´¥ã€‚</p>

<p><code class="highlighter-rouge">@FunctionalInterface</code>æ³¨è§£å¯ä»¥çº¦æŸæ¥å£çš„è¡Œä¸ºï¼Œ<strong>é»˜è®¤æ–¹æ³•</strong>ä¸<strong>é™æ€æ–¹æ³•</strong>ä¸ä¼šå½±å“å‡½æ•°æ¥å£</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@FunctionalInterface</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Functional</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">method</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="13-æ¥å£é»˜è®¤æ–¹æ³•"><code class="highlighter-rouge">1.3</code> æ¥å£é»˜è®¤æ–¹æ³•</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Defaulable</span> <span class="o">{</span>
    <span class="c1">// Interfaces now allow default methods, the implementer may or </span>
    <span class="c1">// may not implement (override) them.</span>
    <span class="k">default</span> <span class="nc">String</span> <span class="nf">notRequired</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="s">"Default implementation"</span><span class="o">;</span> 
    <span class="o">}</span>        
<span class="o">}</span>

<span class="kd">public</span>  <span class="kd">class</span> <span class="nc">DefaultableImpl</span> <span class="kd">implements</span> <span class="nc">Defaulable</span> <span class="o">{</span>
<span class="o">}</span>
     
<span class="kd">public</span>  <span class="kd">class</span> <span class="nc">OverridableImpl</span> <span class="kd">implements</span> <span class="nc">Defaulable</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">notRequired</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"Overridden implementation"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="14-æ¥å£é™æ€æ–¹æ³•"><code class="highlighter-rouge">1.4</code> æ¥å£é™æ€æ–¹æ³•</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">interface</span> <span class="nc">DefaulableFactory</span> <span class="o">{</span>
    <span class="c1">// Interfaces now allow static methods</span>
    <span class="kd">static</span> <span class="nc">Defaulable</span> <span class="nf">create</span><span class="o">(</span> <span class="nc">Supplier</span><span class="o">&lt;</span> <span class="nc">Defaulable</span> <span class="o">&gt;</span> <span class="n">supplier</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">supplier</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="15-æ–¹æ³•å¼•ç”¨"><code class="highlighter-rouge">1.5</code> æ–¹æ³•å¼•ç”¨</h2>

<p>å¯ä»¥å°†ç±»ä¸­æ—¢æœ‰ æ–¹æ³•å¼•ç”¨ä¸ºlambda</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Car</span> <span class="nf">create</span><span class="o">(</span> <span class="kd">final</span> <span class="nc">Supplier</span><span class="o">&lt;</span> <span class="nc">Car</span> <span class="o">&gt;</span> <span class="n">supplier</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">supplier</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">}</span>              
         
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">collide</span><span class="o">(</span> <span class="kd">final</span> <span class="nc">Car</span> <span class="n">car</span> <span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"Collided "</span> <span class="o">+</span> <span class="n">car</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span> <span class="o">);</span>
    <span class="o">}</span>
              
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">repair</span><span class="o">()</span> <span class="o">{</span>   
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"Repaired "</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span> <span class="o">);</span>
    <span class="o">}</span>    
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">follow</span><span class="o">(</span> <span class="kd">final</span> <span class="nc">Car</span> <span class="n">another</span> <span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"Following the "</span> <span class="o">+</span> <span class="n">another</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span> <span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>â‘ æ„é€ å™¨å¼•ç”¨ï¼Œè¯­æ³•ä¸º <code class="highlighter-rouge">Class::new</code>ï¼Œæ•ˆæœå¦‚åŒ <code class="highlighter-rouge">() -&gt; new Class()</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Car</span> <span class="n">car</span> <span class="o">=</span> <span class="nc">Car</span><span class="o">.</span><span class="na">create</span><span class="o">(</span> <span class="nl">Car:</span><span class="o">:</span><span class="k">new</span> <span class="o">);</span>
<span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span> <span class="nc">Car</span> <span class="o">&gt;</span> <span class="n">cars</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span> <span class="n">car</span> <span class="o">);</span>
</code></pre></div></div>

<p>â‘¡é™æ€æ–¹æ³•å¼•ç”¨ï¼Œè¯­æ³•ä¸º <code class="highlighter-rouge">Class::static_method</code>ï¼Œæ•ˆæœå¦‚åŒ <code class="highlighter-rouge">p -&gt; Class.static_method(p)</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cars</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span> <span class="nl">Car:</span><span class="o">:</span><span class="n">collide</span> <span class="o">);</span>
</code></pre></div></div>

<p>â‘¢å®ä¾‹<strong>æ— å‚</strong>æ–¹æ³•å¼•ç”¨ï¼Œè¯­æ³•ä¸º <code class="highlighter-rouge">Class::method</code>ï¼Œæ•ˆæœå¦‚åŒ <code class="highlighter-rouge">p -&gt; p.method()</code>ï¼Œè¯¥æ–¹æ³•æ²¡æœ‰å‚æ•°</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cars</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span> <span class="nl">Car:</span><span class="o">:</span><span class="n">repair</span> <span class="o">);</span>
</code></pre></div></div>

<p>â‘£å®ä¾‹<strong>æœ‰å‚</strong>æ–¹æ³•å¼•ç”¨ï¼Œè¯­æ³•ä¸º <code class="highlighter-rouge">instance::method</code> ï¼Œæ•ˆæœå¦‚åŒ <code class="highlighter-rouge">p -&gt; instance.method(p)</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="nc">Car</span> <span class="n">police</span> <span class="o">=</span> <span class="nc">Car</span><span class="o">.</span><span class="na">create</span><span class="o">(</span> <span class="nl">Car:</span><span class="o">:</span><span class="k">new</span> <span class="o">);</span>
<span class="n">cars</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span> <span class="nl">police:</span><span class="o">:</span><span class="n">follow</span> <span class="o">);</span>
</code></pre></div></div>

<p>â‘¤å…¶ä»–</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="kd">super</span><span class="o">::</span><span class="n">methName</span> <span class="c1">//å¼•ç”¨æŸä¸ªå¯¹è±¡çš„çˆ¶ç±»æ–¹æ³•</span>
   <span class="nc">TypeName</span><span class="o">[]::</span><span class="k">new</span> <span class="c1">//å¼•ç”¨ä¸€ä¸ªæ•°ç»„çš„æ„é€ å™¨</span>
</code></pre></div></div>

<h2 id="16-é‡å¤æ³¨è§£"><code class="highlighter-rouge">1.6</code> é‡å¤æ³¨è§£</h2>

<p>ç›¸åŒçš„æ³¨è§£å¯ä»¥åœ¨åŒä¸€åœ°æ–¹å£°æ˜å¤šæ¬¡ï¼Œç”± <code class="highlighter-rouge">@Repeatable</code> æä¾›æ­¤ç‰¹æ€§</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * @Repeatable( Filters.class )
 * è¡¨ç¤ºè¯¥æ³¨è§£å¯é‡å¤ä½¿ç”¨ï¼Œæ³¨è§£å†…å®¹å­˜æ”¾äºFiltersä¸­
 */</span>
<span class="nd">@Target</span><span class="o">(</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">TYPE</span> <span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span> <span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span> <span class="o">)</span>
<span class="nd">@Repeatable</span><span class="o">(</span> <span class="nc">Filters</span><span class="o">.</span><span class="na">class</span> <span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Filter</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="nf">value</span><span class="o">();</span>
<span class="o">};</span>

<span class="cm">/**
 * å­˜æ”¾@Filteræ³¨è§£çš„æ•°ç»„
 * è¯¥æ³¨è§£å¿…é¡»å¯ä»¥è¢«è®¿é—®
 */</span>
<span class="nd">@Target</span><span class="o">(</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">TYPE</span> <span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span> <span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span> <span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Filters</span> <span class="o">{</span>
    <span class="nc">Filter</span><span class="o">[]</span> <span class="nf">value</span><span class="o">();</span>
<span class="o">}</span>

<span class="cm">/**
 * æµ‹è¯•
 */</span>
<span class="nd">@Filter</span><span class="o">(</span> <span class="s">"filter1"</span> <span class="o">)</span>
<span class="nd">@Filter</span><span class="o">(</span> <span class="s">"filter2"</span> <span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Filterable</span> <span class="o">{</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">//java8 æä¾›çš„æ–°æ–¹æ³•ï¼Œç”¨äºè·å–é‡å¤çš„æ³¨è§£</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">Filter</span> <span class="n">filter</span> <span class="o">:</span> <span class="nc">Filterable</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getAnnotationsByType</span><span class="o">(</span><span class="nc">Filter</span><span class="o">.</span><span class="na">class</span> <span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="n">filter</span><span class="o">.</span><span class="na">value</span><span class="o">()</span> <span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="17-ç±»å‹æ¨æµ‹"><code class="highlighter-rouge">1.7</code> ç±»å‹æ¨æµ‹</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TypeInfer</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="kd">final</span> <span class="nc">Value</span><span class="o">&lt;</span> <span class="nc">String</span> <span class="o">&gt;</span> <span class="n">value</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Value</span><span class="o">&lt;&gt;();</span>

        <span class="c1">//value.setV(Value.&lt;String&gt;defV()); //ä»¥å‰çš„å†™æ³•</span>

        <span class="c1">//Value.defV()è¿”å›ç±»å‹è¢«æ¨æµ‹ä¸ºString</span>
        <span class="n">value</span><span class="o">.</span><span class="na">setV</span><span class="o">(</span><span class="nc">Value</span><span class="o">.</span><span class="na">defV</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">getV</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Value</span><span class="o">&lt;</span> <span class="no">T</span> <span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="no">T</span> <span class="n">o</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span>  <span class="no">T</span> <span class="nf">defV</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//è‹¥Tä¸ä¸ºObject,å°†ä¼šå‡ºç°ç±»å‹è½¬æ¢å¼‚å¸¸</span>
        <span class="k">return</span> <span class="o">(</span><span class="no">T</span><span class="o">)</span><span class="k">new</span> <span class="nc">Object</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setV</span><span class="o">(</span><span class="no">T</span> <span class="n">o</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">o</span> <span class="o">=</span> <span class="n">o</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="no">T</span> <span class="nf">getV</span><span class="o">(){</span>
        <span class="k">return</span> <span class="n">o</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="18-æ‰©å±•æ³¨è§£"><code class="highlighter-rouge">1.8</code> æ‰©å±•æ³¨è§£</h2>

<p>java8å‡ ä¹å¯ä»¥ä¸ºä»»ä½•ä¸œè¥¿æ·»åŠ æ³¨è§£ï¼šå±€éƒ¨å˜é‡ã€æ³›å‹ç±»ã€çˆ¶ç±»ä¸æ¥å£çš„å®ç°ä»¥åŠæ–¹æ³•å¼‚å¸¸</p>

<p><code class="highlighter-rouge">ElementType.TYPE_USE</code>å’Œ<code class="highlighter-rouge">ElementType.TYPE_PARAMETER</code> ç”¨äºæè¿°æ³¨è§£ä¸Šä¸‹æ–‡</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AnnotationEX</span> <span class="o">{</span>
    
    <span class="nd">@Retention</span><span class="o">(</span> <span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span> <span class="o">)</span>
    <span class="nd">@Target</span><span class="o">(</span> <span class="o">{</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">TYPE_USE</span><span class="o">,</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">TYPE_PARAMETER</span> <span class="o">}</span> <span class="o">)</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Anno</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">TestAEX</span><span class="o">&lt;</span> <span class="nd">@Anno</span> <span class="no">T</span> <span class="o">&gt;</span> <span class="kd">extends</span> <span class="nd">@Anno</span> <span class="nc">Object</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span><span class="o">()</span> <span class="kd">throws</span> <span class="nd">@Anno</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="o">}</span>

    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="nc">TestAEX</span><span class="o">&lt;</span> <span class="nc">String</span> <span class="o">&gt;</span> <span class="n">holder</span> <span class="o">=</span> <span class="k">new</span> <span class="nd">@Anno</span> <span class="nc">TestAEX</span><span class="o">&lt;&gt;();</span>
        <span class="nd">@Anno</span> <span class="nc">Collection</span><span class="o">&lt;</span> <span class="nd">@Anno</span> <span class="nc">String</span> <span class="o">&gt;</span> <span class="n">strings</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h1 id="2-ç±»åº“æ–°ç‰¹æ€§"><code class="highlighter-rouge">2</code> ç±»åº“æ–°ç‰¹æ€§</h1>

<h2 id="21-optional"><code class="highlighter-rouge">2.1</code> Optional</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å°†Stringå¯¹è±¡è£…å…¥Optionalå®¹å™¨</span>
<span class="nc">Optional</span><span class="o">&lt;</span> <span class="nc">String</span> <span class="o">&gt;</span> <span class="n">stringOptional</span> <span class="o">=</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span> <span class="kc">null</span> <span class="o">);</span>

<span class="c1">//åˆ¤æ–­å®¹å™¨ä¸­çš„Stringå¯¹è±¡æ˜¯å¦ä¸ä¸ºç©º</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">stringOptional</span><span class="o">.</span><span class="na">isPresent</span><span class="o">()</span> <span class="o">);</span>

<span class="c1">//orElseGeté€šè¿‡lambdaäº§ç”Ÿä¸€ä¸ªé»˜è®¤å€¼</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">stringOptional</span><span class="o">.</span><span class="na">orElseGet</span><span class="o">(</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="s">"[default string]"</span> <span class="o">)</span> <span class="o">);</span>

<span class="c1">//mapå¯¹Stringå¯¹è±¡è¿›è¡Œè½¬åŒ–ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„Optionalå®ä¾‹ï¼Œ</span>
<span class="c1">// æ­¤å¤„sä¸ºnullï¼Œæ‰€ä»¥æœªè½¬æ¢ç›´æ¥è¿”å›äº†1ä¸ªæ–°Optionalå®ä¾‹ï¼Œ</span>
<span class="c1">// orElseç›´æ¥äº§ç”Ÿä¸€ä¸ªé»˜è®¤å€¼</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">stringOptional</span><span class="o">.</span><span class="na">map</span><span class="o">(</span> <span class="n">p</span> <span class="o">-&gt;</span> <span class="s">"["</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s">"]"</span> <span class="o">).</span><span class="na">orElse</span><span class="o">(</span> <span class="s">"Hello Optional"</span> <span class="o">)</span> <span class="o">);</span>
</code></pre></div></div>

<h2 id="22-stream"><code class="highlighter-rouge">2.2</code> Stream</h2>

<p>streamæ“ä½œè¢«åˆ†æˆäº†<strong>ä¸­é—´æ“ä½œ</strong>ä¸<strong>æœ€ç»ˆæ“ä½œ</strong>ä¸¤ç§</p>

<p><strong>ä¸­é—´æ“ä½œ</strong>è¿”å›ä¸€ä¸ªæ–°çš„streamå¯¹è±¡ã€‚ä¸­é—´æ“ä½œæ€»æ˜¯é‡‡ç”¨æƒ°æ€§æ±‚å€¼æ–¹å¼ï¼Œè¿è¡Œä¸€ä¸ªåƒfilterè¿™æ ·çš„ä¸­é—´æ“ä½œå®é™…ä¸Šæ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œç›¸åå®ƒåœ¨éå†å…ƒç´ æ—¶ä¼šäº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„streamå¯¹è±¡ï¼Œè¿™ä¸ªæ–°çš„streamå¯¹è±¡åŒ…å«åŸå§‹streamä¸­ç¬¦åˆç»™å®šè°“è¯çš„æ‰€æœ‰å…ƒç´ ã€‚</p>

<p><strong>æœ€ç»ˆæ“ä½œ</strong>å¯èƒ½ç›´æ¥éå†streamï¼Œäº§ç”Ÿä¸€ä¸ªç»“æœæˆ–å‰¯ä½œç”¨ï¼Œå¦‚forEachã€sumç­‰ã€‚å½“æœ€ç»ˆæ“ä½œæ‰§è¡Œç»“æŸä¹‹åï¼Œstreamç®¡é“è¢«è®¤ä¸ºå·²ç»è¢«æ¶ˆè€—äº†ï¼Œæ²¡æœ‰å¯èƒ½å†è¢«ä½¿ç”¨äº†ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæœ€ç»ˆæ“ä½œéƒ½æ˜¯é‡‡ç”¨åŠæ—©æ±‚å€¼æ–¹å¼ï¼ŒåŠæ—©å®Œæˆåº•å±‚æ•°æ®æºçš„éå†ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Status</span> <span class="o">{</span>
    <span class="no">OPEN</span><span class="o">,</span> <span class="no">CLOSED</span>
<span class="o">};</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Task</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Status</span> <span class="n">status</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Integer</span> <span class="n">points</span><span class="o">;</span>

    <span class="nc">Task</span><span class="o">(</span> <span class="kd">final</span> <span class="nc">Status</span> <span class="n">status</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">Integer</span> <span class="n">points</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">status</span> <span class="o">=</span> <span class="n">status</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">points</span> <span class="o">=</span> <span class="n">points</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">getPoints</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">points</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Status</span> <span class="nf">getStatus</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">status</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span> <span class="s">"[%s, %d]"</span><span class="o">,</span> <span class="n">status</span><span class="o">,</span> <span class="n">points</span> <span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
    <span class="nc">Collection</span><span class="o">&lt;</span> <span class="nc">Task</span> <span class="o">&gt;</span> <span class="n">tasks</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span>
            <span class="k">new</span> <span class="nf">Task</span><span class="o">(</span> <span class="nc">Status</span><span class="o">.</span><span class="na">OPEN</span><span class="o">,</span> <span class="mi">5</span> <span class="o">),</span>
            <span class="k">new</span> <span class="nf">Task</span><span class="o">(</span> <span class="nc">Status</span><span class="o">.</span><span class="na">OPEN</span><span class="o">,</span> <span class="mi">13</span> <span class="o">),</span>
            <span class="k">new</span> <span class="nf">Task</span><span class="o">(</span> <span class="nc">Status</span><span class="o">.</span><span class="na">CLOSED</span><span class="o">,</span> <span class="mi">8</span> <span class="o">)</span>
    <span class="o">);</span>

    <span class="kt">long</span> <span class="n">totalPointsOfOpenTasks</span> <span class="o">=</span> <span class="n">tasks</span>
            <span class="o">.</span><span class="na">stream</span><span class="o">()</span>
            <span class="o">.</span><span class="na">filter</span><span class="o">(</span> <span class="n">task</span> <span class="o">-&gt;</span> <span class="n">task</span><span class="o">.</span><span class="na">getStatus</span><span class="o">()</span> <span class="o">==</span> <span class="nc">Status</span><span class="o">.</span><span class="na">OPEN</span> <span class="o">)</span>
            <span class="o">.</span><span class="na">mapToInt</span><span class="o">(</span> <span class="nl">Task:</span><span class="o">:</span><span class="n">getPoints</span> <span class="o">)</span>
            <span class="o">.</span><span class="na">sum</span><span class="o">();</span>

    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"Total points: "</span> <span class="o">+</span> <span class="n">totalPointsOfOpenTasks</span> <span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>åŸç”Ÿå¹¶è¡Œå¤„ç†</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">double</span> <span class="n">totalPoints</span> <span class="o">=</span> <span class="n">tasks</span>
   <span class="o">.</span><span class="na">stream</span><span class="o">()</span>
   <span class="o">.</span><span class="na">parallel</span><span class="o">()</span>
   <span class="o">.</span><span class="na">map</span><span class="o">(</span> <span class="n">task</span> <span class="o">-&gt;</span> <span class="n">task</span><span class="o">.</span><span class="na">getPoints</span><span class="o">()</span> <span class="o">)</span> <span class="c1">// or map( Task::getPoints ) </span>
   <span class="o">.</span><span class="na">reduce</span><span class="o">(</span> <span class="mi">0</span><span class="o">,</span> <span class="nl">Integer:</span><span class="o">:</span><span class="n">sum</span> <span class="o">);</span>    
   
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"Total points (all tasks): "</span> <span class="o">+</span> <span class="n">totalPoints</span> <span class="o">);</span>
</code></pre></div></div>

<p>åˆ†ç»„</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="nc">Map</span><span class="o">&lt;</span> <span class="nc">Status</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span> <span class="nc">Task</span> <span class="o">&gt;&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="n">tasks</span>
        <span class="o">.</span><span class="na">stream</span><span class="o">()</span>
        <span class="o">.</span><span class="na">collect</span><span class="o">(</span> <span class="nc">Collectors</span><span class="o">.</span><span class="na">groupingBy</span><span class="o">(</span><span class="nl">Task:</span><span class="o">:</span><span class="n">getStatus</span><span class="o">)</span> <span class="o">);</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="n">map</span> <span class="o">);</span>
</code></pre></div></div>

<p>æƒé‡</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//è®¡ç®—æƒé‡</span>
<span class="kd">final</span> <span class="nc">Collection</span><span class="o">&lt;</span> <span class="nc">String</span> <span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">tasks</span>
        <span class="o">.</span><span class="na">stream</span><span class="o">()</span>                                        <span class="c1">// Stream&lt; String &gt;</span>
        <span class="o">.</span><span class="na">mapToInt</span><span class="o">(</span> <span class="nl">Task:</span><span class="o">:</span><span class="n">getPoints</span> <span class="o">)</span>                     <span class="c1">// IntStream</span>
        <span class="o">.</span><span class="na">asLongStream</span><span class="o">()</span>                                  <span class="c1">// LongStream</span>
        <span class="o">.</span><span class="na">mapToDouble</span><span class="o">(</span> <span class="n">points</span> <span class="o">-&gt;</span> <span class="n">points</span> <span class="o">/</span> <span class="n">totalPoints</span> <span class="o">)</span>   <span class="c1">// DoubleStream</span>
        <span class="o">.</span><span class="na">boxed</span><span class="o">()</span>                                         <span class="c1">// Stream&lt; Double &gt;</span>
        <span class="o">.</span><span class="na">mapToLong</span><span class="o">(</span> <span class="n">weigth</span> <span class="o">-&gt;</span> <span class="o">(</span> <span class="kt">long</span> <span class="o">)(</span> <span class="n">weigth</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">)</span> <span class="o">)</span> <span class="c1">// LongStream</span>
        <span class="o">.</span><span class="na">mapToObj</span><span class="o">(</span> <span class="n">percentage</span> <span class="o">-&gt;</span> <span class="n">percentage</span> <span class="o">+</span> <span class="s">"%"</span> <span class="o">)</span>      <span class="c1">// Stream&lt; String&gt;</span>
        <span class="o">.</span><span class="na">collect</span><span class="o">(</span> <span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">()</span> <span class="o">);</span>                 <span class="c1">// List&lt; String &gt;</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="n">result</span> <span class="o">);</span>
</code></pre></div></div>

<h2 id="23-datetime-api"><code class="highlighter-rouge">2.3</code> Date/Time API</h2>

<p>æ—¶é—´æ ¼å¼å‡ä¸º <strong>ISO-8601</strong></p>

<p><code class="highlighter-rouge">Clock</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//æ—¥æœŸæ—¶é—´éƒ½æœ‰ï¼Œæœ‰æ—¶åŒº</span>
<span class="nc">Clock</span> <span class="n">clock</span> <span class="o">=</span> <span class="nc">Clock</span><span class="o">.</span><span class="na">systemUTC</span><span class="o">();</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">clock</span><span class="o">.</span><span class="na">instant</span><span class="o">());</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">clock</span><span class="o">.</span><span class="na">millis</span><span class="o">());</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">LocalDate</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//åªæœ‰æ—¥æœŸæ²¡æœ‰æ—¶é—´</span>
<span class="nc">LocalDate</span> <span class="n">localDate</span> <span class="o">=</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
<span class="nc">LocalDate</span> <span class="n">localDateFromClock</span> <span class="o">=</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="na">now</span><span class="o">(</span><span class="n">clock</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">localDate</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">localDateFromClock</span><span class="o">);</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">LocalTime</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//åªæœ‰æ—¶é—´æ²¡æœ‰æ—¥æœŸ</span>
<span class="nc">LocalTime</span> <span class="n">localTime</span> <span class="o">=</span> <span class="nc">LocalTime</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
<span class="nc">LocalTime</span> <span class="n">localTimeFromClock</span> <span class="o">=</span> <span class="nc">LocalTime</span><span class="o">.</span><span class="na">now</span><span class="o">(</span><span class="n">clock</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">localTime</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">localTimeFromClock</span><span class="o">);</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">LocalDateTime </code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//æ—¥æœŸæ—¶é—´éƒ½æœ‰ï¼Œæ²¡æœ‰æ—¶åŒº</span>
<span class="nc">LocalDateTime</span> <span class="n">localDateTime</span> <span class="o">=</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
<span class="nc">LocalDateTime</span> <span class="n">localDateTimeFromClock</span> <span class="o">=</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(</span><span class="n">clock</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">localDateTime</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">localDateTimeFromClock</span><span class="o">);</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">ZonedDateTime</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//æŒ‡å®šæ—¶åŒºï¼Œåªæœ‰ZonedDateTimeï¼Œæ²¡æœ‰ZoneDateä¸ZoneTime</span>
<span class="nc">ZonedDateTime</span> <span class="n">zonedDateTime</span> <span class="o">=</span> <span class="nc">ZonedDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
<span class="nc">ZonedDateTime</span> <span class="n">zonedDateTimeFromClock</span> <span class="o">=</span> <span class="nc">ZonedDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
<span class="nc">ZonedDateTime</span> <span class="n">zonedDateTimeFromZone</span> <span class="o">=</span> <span class="nc">ZonedDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">(</span><span class="nc">ZoneId</span><span class="o">.</span><span class="na">of</span><span class="o">(</span> <span class="s">"America/Los_Angeles"</span> <span class="o">));</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">zonedDateTime</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">zonedDateTimeFromClock</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">zonedDateTimeFromZone</span><span class="o">);</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">Duration</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//è®¡ç®—æ—¶é—´å·®</span>
<span class="nc">LocalDateTime</span> <span class="n">from</span> <span class="o">=</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">of</span><span class="o">(</span> <span class="mi">2014</span><span class="o">,</span> <span class="nc">Month</span><span class="o">.</span><span class="na">APRIL</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span> <span class="o">);</span>
<span class="nc">LocalDateTime</span> <span class="n">to</span> <span class="o">=</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">of</span><span class="o">(</span> <span class="mi">2015</span><span class="o">,</span> <span class="nc">Month</span><span class="o">.</span><span class="na">APRIL</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="mi">59</span><span class="o">,</span> <span class="mi">59</span> <span class="o">);</span>
<span class="nc">Duration</span> <span class="n">duration</span> <span class="o">=</span> <span class="nc">Duration</span><span class="o">.</span><span class="na">between</span><span class="o">(</span> <span class="n">from</span><span class="o">,</span> <span class="n">to</span> <span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"Duration in days: "</span> <span class="o">+</span> <span class="n">duration</span><span class="o">.</span><span class="na">toDays</span><span class="o">()</span> <span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"Duration in hours: "</span> <span class="o">+</span> <span class="n">duration</span><span class="o">.</span><span class="na">toHours</span><span class="o">()</span> <span class="o">);</span>
</code></pre></div></div>

<h2 id="24-nashorn"><code class="highlighter-rouge">2.4</code> Nashorn</h2>

<p><code class="highlighter-rouge">javax.script.ScriptEngine</code>çš„å¦ä¸€ç§å®ç°ï¼Œå…è®¸jsä¸javaç›¸äº’è°ƒç”¨</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ScriptEngineManager</span> <span class="n">manager</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ScriptEngineManager</span><span class="o">();</span>
<span class="nc">ScriptEngine</span> <span class="n">engine</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="na">getEngineByName</span><span class="o">(</span> <span class="s">"JavaScript"</span> <span class="o">);</span>
         
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="n">engine</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">()</span> <span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"Result:"</span> <span class="o">+</span> <span class="n">engine</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span> <span class="s">"function f() { return 1; }; f() + 1;"</span> <span class="o">)</span> <span class="o">);</span>
</code></pre></div></div>

<h2 id="25-base64"><code class="highlighter-rouge">2.5</code> Base64</h2>

<p>Base64ç¼–ç å·²ç»æˆä¸ºJava8ç±»åº“çš„æ ‡å‡†</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="nc">String</span> <span class="n">text</span> <span class="o">=</span> <span class="s">"Base64 finally in Java 8!"</span><span class="o">;</span>

<span class="kd">final</span> <span class="nc">String</span> <span class="n">encoded</span> <span class="o">=</span> <span class="nc">Base64</span>
        <span class="o">.</span><span class="na">getEncoder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">encodeToString</span><span class="o">(</span> <span class="n">text</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span> <span class="o">)</span> <span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="n">encoded</span> <span class="o">);</span>

<span class="kd">final</span> <span class="nc">String</span> <span class="n">decoded</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span>
        <span class="nc">Base64</span><span class="o">.</span><span class="na">getDecoder</span><span class="o">().</span><span class="na">decode</span><span class="o">(</span> <span class="n">encoded</span> <span class="o">),</span>
        <span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span> <span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="n">decoded</span> <span class="o">);</span>
</code></pre></div></div>

<blockquote>
  <p>å…¶ä»–ç¼–ç å™¨ä¸è§£ç å™¨</p>

  <p><code class="highlighter-rouge">Base64.getUrlEncoder() Base64.getUrlDecoder()</code></p>

  <p><code class="highlighter-rouge">Base64.getMimeEncoder() Base64.getMimeDecoder()</code></p>
</blockquote>

<h2 id="26-å¹¶è¡Œparallel-æ•°ç»„"><code class="highlighter-rouge">2.6</code> å¹¶è¡Œï¼ˆparallel ï¼‰æ•°ç»„</h2>

<p><strong>å¹¶è¡Œæ•°ç»„</strong>æ“ä½œå¯ä»¥åœ¨å¤šæ ¸æœºå™¨ä¸Šæå¤§æé«˜æ€§èƒ½</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span><span class="o">[]</span> <span class="n">arrayOfLong</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span> <span class="o">[</span> <span class="mi">20000</span> <span class="o">];</span>

<span class="c1">//å¯¹arrayLongæ‰€æœ‰å…ƒç´ éšæœºèµ‹å€¼</span>
<span class="nc">Arrays</span><span class="o">.</span><span class="na">parallelSetAll</span><span class="o">(</span><span class="n">arrayOfLong</span><span class="o">,</span>
        <span class="n">index</span> <span class="o">-&gt;</span> <span class="nc">ThreadLocalRandom</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">1000000</span><span class="o">));</span>

<span class="c1">//æ‰“å°å‰10ä¸ªå…ƒç´ </span>
<span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span> <span class="n">arrayOfLong</span> <span class="o">).</span><span class="na">limit</span><span class="o">(</span> <span class="mi">10</span> <span class="o">).</span><span class="na">forEach</span><span class="o">(</span>
        <span class="n">i</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span> <span class="n">i</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">)</span> <span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>

<span class="c1">//å¯¹arrayLongæ•°ç»„æ’åº</span>
<span class="nc">Arrays</span><span class="o">.</span><span class="na">parallelSort</span><span class="o">(</span> <span class="n">arrayOfLong</span> <span class="o">);</span>

<span class="c1">//æ‰“å°å‰10ä¸ªå…ƒç´ </span>
<span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span> <span class="n">arrayOfLong</span> <span class="o">).</span><span class="na">limit</span><span class="o">(</span> <span class="mi">10</span> <span class="o">).</span><span class="na">forEach</span><span class="o">(</span>
        <span class="n">i</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span> <span class="n">i</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">)</span> <span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
</code></pre></div></div>

<h2 id="27-å¹¶å‘concurrency"><code class="highlighter-rouge">2.7</code> å¹¶å‘ï¼ˆconcurrencyï¼‰</h2>

<ul>
  <li>
    <p>java.util.concurrent.<code class="highlighter-rouge">ConcurrentHashMap</code>ç±»ä¸­åŠ å…¥äº†ä¸€äº›æ–°æ–¹æ³•æ¥æ”¯æŒèšé›†æ“ä½œ</p>
  </li>
  <li>
    <p>java.util.concurrent.<code class="highlighter-rouge">ForkJoinPool</code>ç±»ä¸­åŠ å…¥äº†ä¸€äº›æ–°æ–¹æ³•æ¥æ”¯æŒå…±æœ‰èµ„æºæ± ï¼ˆcommon poolï¼‰</p>
  </li>
  <li>
    <p>java.util.concurrent.locks.<code class="highlighter-rouge">StampedLock</code>ç±»æä¾›åŸºäºå®¹é‡çš„é”ï¼Œè¿™ç§é”æœ‰ä¸‰ä¸ªæ¨¡å‹æ¥æ§åˆ¶è¯»å†™æ“ä½œ</p>
  </li>
  <li>
    <p>java.util.concurrent.atomicåŒ…ä¸­å¢åŠ æ–°ç±»ï¼š<br />
<code class="highlighter-rouge">DoubleAccumulator</code>ï¼Œ<br />
<code class="highlighter-rouge">DoubleAdder</code>ï¼Œ<br />
<code class="highlighter-rouge">LongAccumulator</code>ï¼Œ<br />
<code class="highlighter-rouge">LongAdder</code></p>
  </li>
</ul>

<h1 id="3-ç¼–è¯‘å™¨æ–°ç‰¹æ€§"><code class="highlighter-rouge">3</code> ç¼–è¯‘å™¨æ–°ç‰¹æ€§</h1>

<h2 id="31-å‚æ•°å"><code class="highlighter-rouge">3.1</code> å‚æ•°å</h2>

<p>æ–¹æ³•å‚æ•°çš„åå­—ä¿ç•™åœ¨Javaå­—èŠ‚ç ä¸­ï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨è¿è¡Œæ—¶è·å–å®ƒä»¬</p>

<p>ç¼–è¯‘æ—¶éœ€è¦åŠ ä¸Š <code class="highlighter-rouge">â€“parameters</code> ï¼Œ<strong>maven-compiler-plugin</strong> å¯è¿›è¡Œé…ç½®</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ParameterNames</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="nc">ParameterNames</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getMethod</span><span class="o">(</span> <span class="s">"main"</span><span class="o">,</span> <span class="nc">String</span><span class="o">[].</span><span class="na">class</span> <span class="o">);</span>
        <span class="k">for</span><span class="o">(</span> <span class="kd">final</span> <span class="nc">Parameter</span> <span class="nl">parameter:</span> <span class="n">method</span><span class="o">.</span><span class="na">getParameters</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"Parameter: "</span> <span class="o">+</span> <span class="n">parameter</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h1 id="4-æ–°çš„javaå·¥å…·"><code class="highlighter-rouge">4</code> æ–°çš„Javaå·¥å…·</h1>

<h2 id="41-nashornå¼•æ“-jjs"><code class="highlighter-rouge">4.1</code> Nashornå¼•æ“ <code class="highlighter-rouge">jjs</code></h2>

<p>å®ƒæ¥å—ä¸€äº›JavaScriptæºä»£ç ä¸ºå‚æ•°ï¼Œå¹¶ä¸”æ‰§è¡Œè¿™äº›æºä»£ç </p>

<p>åˆ›å»º <strong>func.js</strong> æ–‡ä»¶</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">f</span><span class="p">()</span> <span class="p">{</span> 
     <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> 
<span class="p">};</span> 
 
<span class="nx">print</span><span class="p">(</span> <span class="nx">f</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">);</span>
</code></pre></div></div>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jjs func.js
</code></pre></div></div>

<h2 id="42-ç±»ä¾èµ–åˆ†æå™¨-jdeps"><code class="highlighter-rouge">4.2</code> ç±»ä¾èµ–åˆ†æå™¨ <code class="highlighter-rouge">jdeps</code></h2>

<p>å®ƒå¯ä»¥æ˜¾ç¤ºJavaç±»çš„åŒ…çº§åˆ«æˆ–ç±»çº§åˆ«çš„ä¾èµ–ï¼Œå®ƒæ¥å—ä¸€ä¸ª.classæ–‡ä»¶ï¼Œä¸€ä¸ªç›®å½•ï¼Œæˆ–è€…ä¸€ä¸ªjaræ–‡ä»¶ä½œä¸ºè¾“å…¥ã€‚jdepsé»˜è®¤æŠŠç»“æœè¾“å‡ºåˆ°ç³»ç»Ÿè¾“å‡ºï¼ˆæ§åˆ¶å°ï¼‰ä¸Šã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jdeps org.springframework.core-3.0.5.RELEASE.jar
</code></pre></div></div>

<p>å¦‚æœä¾èµ–ä¸åœ¨classpathä¸­ï¼Œå°±ä¼šæ˜¾ç¤º <strong>not found</strong></p>

<h1 id="5-jvmæ–°ç‰¹æ€§"><code class="highlighter-rouge">5</code> JVMæ–°ç‰¹æ€§</h1>

<p><strong>PermGen</strong>ç©ºé—´è¢«ç§»é™¤äº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯<strong>Metaspace</strong>ï¼ˆJEP 122ï¼‰ã€‚JVMé€‰é¡¹<strong>-XX:PermSize</strong>ä¸<strong>-XX:MaxPermSize</strong>åˆ†åˆ«è¢«<strong>-XX:MetaSpaceSize</strong>ä¸<strong>-XX:MaxMetaspaceSize</strong>æ‰€ä»£æ›¿</p>
:ET