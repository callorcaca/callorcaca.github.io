I""û<ul id="markdown-toc">
  <li><a href="#ä¸€äº§å“" id="markdown-toc-ä¸€äº§å“"><code class="highlighter-rouge">ä¸€</code>ã€äº§å“</a></li>
  <li><a href="#äºŒjdkå‘å¸ƒä¸è°ƒç”¨" id="markdown-toc-äºŒjdkå‘å¸ƒä¸è°ƒç”¨"><code class="highlighter-rouge">äºŒ</code>ã€JDKå‘å¸ƒä¸è°ƒç”¨</a>    <ul>
      <li><a href="#1å‘å¸ƒ" id="markdown-toc-1å‘å¸ƒ"><code class="highlighter-rouge">1</code>.å‘å¸ƒ</a>        <ul>
          <li><a href="#å®šä¹‰æ¥å£" id="markdown-toc-å®šä¹‰æ¥å£">å®šä¹‰æ¥å£</a></li>
          <li><a href="#å®ç°æ¥å£" id="markdown-toc-å®ç°æ¥å£">å®ç°æ¥å£</a></li>
          <li><a href="#å‘å¸ƒæœåŠ¡" id="markdown-toc-å‘å¸ƒæœåŠ¡">å‘å¸ƒæœåŠ¡</a></li>
        </ul>
      </li>
      <li><a href="#2è°ƒç”¨" id="markdown-toc-2è°ƒç”¨"><code class="highlighter-rouge">2</code>.è°ƒç”¨</a>        <ul>
          <li><a href="#é™æ€å®¢æˆ·ç«¯" id="markdown-toc-é™æ€å®¢æˆ·ç«¯">é™æ€å®¢æˆ·ç«¯</a></li>
          <li><a href="#åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯" id="markdown-toc-åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯">åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#ä¸‰cxf" id="markdown-toc-ä¸‰cxf"><code class="highlighter-rouge">ä¸‰</code>ã€CXF</a>    <ul>
      <li><a href="#1soapé£æ ¼" id="markdown-toc-1soapé£æ ¼"><code class="highlighter-rouge">1.</code>SOAPé£æ ¼</a>        <ul>
          <li><a href="#å®šä¹‰æ¥å£-1" id="markdown-toc-å®šä¹‰æ¥å£-1">å®šä¹‰æ¥å£</a></li>
          <li><a href="#å®ç°æ¥å£-1" id="markdown-toc-å®ç°æ¥å£-1">å®ç°æ¥å£</a></li>
          <li><a href="#å‘å¸ƒæœåŠ¡-1" id="markdown-toc-å‘å¸ƒæœåŠ¡-1">å‘å¸ƒæœåŠ¡</a>            <ul>
              <li><a href="#jettyå‘å¸ƒ" id="markdown-toc-jettyå‘å¸ƒ">â‘ Jettyå‘å¸ƒ</a></li>
              <li><a href="#webå‘å¸ƒ" id="markdown-toc-webå‘å¸ƒ">â‘¡Webå‘å¸ƒ</a></li>
            </ul>
          </li>
          <li><a href="#è°ƒç”¨æœåŠ¡" id="markdown-toc-è°ƒç”¨æœåŠ¡">è°ƒç”¨æœåŠ¡</a>            <ul>
              <li><a href="#é™æ€å®¢æˆ·ç«¯-1" id="markdown-toc-é™æ€å®¢æˆ·ç«¯-1">â‘ é™æ€å®¢æˆ·ç«¯</a></li>
              <li><a href="#åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯-1" id="markdown-toc-åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯-1">â‘¡åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯</a></li>
              <li><a href="#é€šç”¨åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯" id="markdown-toc-é€šç”¨åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯">â‘¢é€šç”¨åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯</a></li>
              <li><a href="#springå®¢æˆ·ç«¯" id="markdown-toc-springå®¢æˆ·ç«¯">â‘£Springå®¢æˆ·ç«¯</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="#2resté£æ ¼" id="markdown-toc-2resté£æ ¼"><code class="highlighter-rouge">2</code>.RESTé£æ ¼</a>        <ul>
          <li><a href="#å®šä¹‰æ¥å£-2" id="markdown-toc-å®šä¹‰æ¥å£-2">å®šä¹‰æ¥å£</a></li>
          <li><a href="#å®ç°æ¥å£-2" id="markdown-toc-å®ç°æ¥å£-2">å®ç°æ¥å£</a></li>
          <li><a href="#å‘å¸ƒæœåŠ¡-2" id="markdown-toc-å‘å¸ƒæœåŠ¡-2">å‘å¸ƒæœåŠ¡</a>            <ul>
              <li><a href="#jettyå‘å¸ƒ-1" id="markdown-toc-jettyå‘å¸ƒ-1">â‘ jettyå‘å¸ƒ</a></li>
              <li><a href="#webå‘å¸ƒ-1" id="markdown-toc-webå‘å¸ƒ-1">â‘¡webå‘å¸ƒ</a></li>
            </ul>
          </li>
          <li><a href="#è°ƒç”¨æœåŠ¡-1" id="markdown-toc-è°ƒç”¨æœåŠ¡-1">è°ƒç”¨æœåŠ¡</a>            <ul>
              <li><a href="#jax-rs-10-å®¢æˆ·ç«¯" id="markdown-toc-jax-rs-10-å®¢æˆ·ç«¯">â‘ JAX-RS 1.0 å®¢æˆ·ç«¯</a></li>
              <li><a href="#jax-rs-20-å®¢æˆ·ç«¯" id="markdown-toc-jax-rs-20-å®¢æˆ·ç«¯">â‘¡JAX-RS 2.0 å®¢æˆ·ç«¯</a></li>
              <li><a href="#webclient-å®¢æˆ·ç«¯" id="markdown-toc-webclient-å®¢æˆ·ç«¯">â‘¢WebClient å®¢æˆ·ç«¯</a></li>
              <li><a href="#ajaxå®¢æˆ·ç«¯" id="markdown-toc-ajaxå®¢æˆ·ç«¯">â‘£AJAXå®¢æˆ·ç«¯</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="#è­¦å‘Š" id="markdown-toc-è­¦å‘Š"><code class="highlighter-rouge">ï½ï½</code>è­¦å‘Š<code class="highlighter-rouge">ï½ï½</code></a></li>
    </ul>
  </li>
</ul>

<p><strong>WSDL</strong></p>

<p><code class="highlighter-rouge">definitions</code> ä¸ºæ ¹èŠ‚ç‚¹ï¼Œå±æ€§ä¸º</p>

<blockquote>
  <p><code class="highlighter-rouge">name</code>ï¼šWS åç§°ï¼Œé»˜è®¤ä¸ºâ€œå®ç°ç±» + Serviceâ€</p>

  <p><code class="highlighter-rouge">targetNamespace</code>ï¼šWS ç›®æ ‡å‘½åç©ºé—´ï¼Œé»˜è®¤ä¸ºâ€œWS å®ç°ç±»å¯¹åº”åŒ…åå€’æ’åæ„æˆçš„åœ°å€â€</p>
</blockquote>

<p><code class="highlighter-rouge">definitions</code>çš„5ä¸ªå­èŠ‚ç‚¹</p>

<blockquote>
  <p><code class="highlighter-rouge">types</code>ï¼šæè¿°äº† WS ä¸­æ‰€æ¶‰åŠçš„æ•°æ®ç±»å‹</p>

  <p><code class="highlighter-rouge">portType</code>ï¼šå®šä¹‰äº† WS æ¥å£åç§°<code class="highlighter-rouge">portType.name</code>ï¼ˆ<code class="highlighter-rouge">endpointInterface</code>é»˜è®¤ä¸ºâ€œWS å®ç°ç±»æ‰€å®ç°çš„æ¥å£â€ï¼‰ï¼ŒåŠå…¶æ“ä½œåç§°ï¼Œä»¥åŠæ¯ä¸ªæ“ä½œçš„è¾“å…¥ä¸è¾“å‡ºæ¶ˆæ¯</p>

  <p><code class="highlighter-rouge">message</code>ï¼šå¯¹ç›¸å…³æ¶ˆæ¯è¿›è¡Œäº†å®šä¹‰ï¼ˆä¾› types ä¸ portType ä½¿ç”¨ï¼‰</p>

  <p><code class="highlighter-rouge">binding</code>ï¼šæä¾›äº†å¯¹ WS çš„æ•°æ®ç»‘å®šæ–¹å¼</p>

  <p><code class="highlighter-rouge">service</code>ï¼šWS åç§°åŠå…¶ç«¯å£åç§°<code class="highlighter-rouge">service_port.name</code>ï¼ˆ<code class="highlighter-rouge">portName</code>é»˜è®¤ä¸ºâ€œWS å®ç°ç±» + Portâ€ï¼‰ï¼Œä»¥åŠå¯¹åº”çš„ WSDL åœ°å€</p>
</blockquote>

<p><strong>SOAP</strong></p>

<p><code class="highlighter-rouge">header</code></p>

<p><code class="highlighter-rouge">body</code></p>

<hr />

<h1 id="ä¸€äº§å“"><code class="highlighter-rouge">ä¸€</code>ã€äº§å“</h1>

<p><strong>soap</strong>é£æ ¼ (JAX-WSè§„èŒƒJSR-224)</p>

<p>JAX-WS RIï¼šhttps://jax-ws.java.net/    Oracle å®˜æ–¹æä¾›çš„å®ç°</p>

<p>Axisï¼šhttp://axis.apache.org/</p>

<p>CXFï¼šhttp://cxf.apache.org/</p>

<p><strong>rest</strong>é£æ ¼ (JAX-RSè§„èŒƒJSR-339)</p>

<p>Jerseyï¼šhttps://jersey.java.net/    Oracle å®˜æ–¹æä¾›çš„å®ç°</p>

<p>Restletï¼šhttp://restlet.com/</p>

<p>RESTEasyï¼šhttp://resteasy.jboss.org/</p>

<p>CXFï¼šhttp://cxf.apache.org/</p>

<h1 id="äºŒjdkå‘å¸ƒä¸è°ƒç”¨"><code class="highlighter-rouge">äºŒ</code>ã€JDKå‘å¸ƒä¸è°ƒç”¨</h1>

<h2 id="1å‘å¸ƒ"><code class="highlighter-rouge">1</code>.å‘å¸ƒ</h2>

<h3 id="å®šä¹‰æ¥å£">å®šä¹‰æ¥å£</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//æ­¤æ³¨è§£å¿…é¡»</span>
<span class="nd">@WebService</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">HelloService</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="nf">say</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="å®ç°æ¥å£">å®ç°æ¥å£</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@WebService</span><span class="o">(</span><span class="n">serviceName</span> <span class="o">=</span> <span class="s">"HelloService"</span><span class="o">,</span>
        <span class="n">portName</span> <span class="o">=</span> <span class="s">"HelloServicePort"</span><span class="o">,</span>
        <span class="n">endpointInterface</span> <span class="o">=</span> <span class="s">"org.sllx.practice.jdkws.HelloService"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloServiceImpl</span> <span class="kd">implements</span> <span class="nc">HelloService</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">say</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"helloWorld"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="å‘å¸ƒæœåŠ¡">å‘å¸ƒæœåŠ¡</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Server</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="nc">String</span> <span class="n">address</span> <span class="o">=</span> <span class="s">"http://localhost:8081/ws/soap/hello"</span><span class="o">;</span>
        <span class="nc">HelloService</span> <span class="n">helloService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HelloServiceImpl</span><span class="o">();</span>
        <span class="nc">Endpoint</span><span class="o">.</span><span class="na">publish</span><span class="o">(</span><span class="n">address</span><span class="o">,</span> <span class="n">helloService</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"ws is published ["</span> <span class="o">+</span> <span class="n">address</span> <span class="o">+</span> <span class="s">"?wsdl]"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>è®¿é—®<code class="highlighter-rouge">http://localhost:8081/ws/soap/hello?wsdl</code>å³å¯æŸ¥çœ‹è¯¦æƒ…</p>

<h2 id="2è°ƒç”¨"><code class="highlighter-rouge">2</code>.è°ƒç”¨</h2>

<h3 id="é™æ€å®¢æˆ·ç«¯">é™æ€å®¢æˆ·ç«¯</h3>

<p><code class="highlighter-rouge">wsimport http://localhost:8080/ws/soap/hello?wsdl</code>//é€šè¿‡ WSDL åœ°å€ç”Ÿæˆ class æ–‡ä»¶</p>

<p><code class="highlighter-rouge">jar -cf client.jar .</code> //é€šè¿‡ jar å‘½ä»¤å°†è‹¥å¹² class æ–‡ä»¶å‹ç¼©ä¸ºä¸€ä¸ª jar åŒ…</p>

<p><code class="highlighter-rouge">rmdir /s/q demo </code>//åˆ é™¤ç”Ÿæˆçš„ class æ–‡ä»¶ï¼ˆåˆ é™¤æ ¹ç›®å½•å³å¯ï¼‰</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
     <span class="n">HelloService_Service</span> <span class="n">hss</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HelloService_Service</span><span class="o">();</span>
     <span class="nc">HelloService</span> <span class="n">hs</span> <span class="o">=</span> <span class="n">hss</span><span class="o">.</span><span class="na">getHelloServicePort</span><span class="o">();</span>
     <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">hs</span><span class="o">.</span><span class="na">say</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯">åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯</h3>

<p>åªéœ€æä¾›<code class="highlighter-rouge">HelloService</code>æ¥å£ï¼Œæ— éœ€jar</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="no">URL</span> <span class="n">wsdl</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span><span class="o">(</span><span class="s">"http://localhost:8081/ws/soap/hello?wsdl"</span><span class="o">);</span>
        <span class="nc">QName</span> <span class="n">serviceName</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QName</span><span class="o">(</span><span class="s">"http://jdkws.practice.sllx.org/"</span><span class="o">,</span> <span class="s">"HelloService"</span><span class="o">);</span>
        <span class="nc">QName</span> <span class="n">portName</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QName</span><span class="o">(</span><span class="s">"http://jdkws.practice.sllx.org/"</span><span class="o">,</span> <span class="s">"HelloServicePort"</span><span class="o">);</span>
        <span class="nc">Service</span> <span class="n">service</span> <span class="o">=</span> <span class="nc">Service</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">wsdl</span><span class="o">,</span> <span class="n">serviceName</span><span class="o">);</span>
        <span class="nc">HelloService</span> <span class="n">helloService</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="na">getPort</span><span class="o">(</span><span class="n">portName</span><span class="o">,</span> <span class="nc">HelloService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">helloService</span><span class="o">.</span><span class="na">say</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h1 id="ä¸‰cxf"><code class="highlighter-rouge">ä¸‰</code>ã€CXF</h1>

<p>Userä¸ºè‡ªå®šä¹‰çš„POJOç±»</p>

<p>webå‘å¸ƒç¤ºä¾‹é›†æˆspring</p>

<h2 id="1soapé£æ ¼"><code class="highlighter-rouge">1.</code>SOAPé£æ ¼</h2>

<h3 id="å®šä¹‰æ¥å£-1">å®šä¹‰æ¥å£</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">top</span><span class="o">.</span><span class="na">rainynight</span><span class="o">.</span><span class="na">sitews</span><span class="o">.</span><span class="na">user</span><span class="o">.</span><span class="na">ws</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">top.rainynight.sitews.user.entity.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.jws.WebService</span><span class="o">;</span>

<span class="nd">@WebService</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserWS</span> <span class="o">{</span>

    <span class="nc">User</span> <span class="nf">lookOver</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="å®ç°æ¥å£-1">å®ç°æ¥å£</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">top</span><span class="o">.</span><span class="na">rainynight</span><span class="o">.</span><span class="na">sitews</span><span class="o">.</span><span class="na">user</span><span class="o">.</span><span class="na">ws</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">top.rainynight.sitews.user.entity.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>

<span class="nd">@Component</span><span class="o">(</span><span class="s">"userWS"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserWSImpl</span> <span class="kd">implements</span> <span class="nc">UserWS</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">lookOver</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">User</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="å‘å¸ƒæœåŠ¡-1">å‘å¸ƒæœåŠ¡</h3>

<h4 id="jettyå‘å¸ƒ">â‘ Jettyå‘å¸ƒ</h4>

<p>é…ç½®ä¾èµ–</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;properties&gt;</span>
    <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
    <span class="nt">&lt;cxf.version&gt;</span>3.0.0<span class="nt">&lt;/cxf.version&gt;</span>
<span class="nt">&lt;/properties&gt;</span>

<span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.apache.cxf<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>cxf-rt-frontend-jaxws<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>${cxf.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.apache.cxf<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>cxf-rt-transports-http-jetty<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>${cxf.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
</code></pre></div></div>

<p>å‘å¸ƒ</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JaxWsServer</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">JaxWsServerFactoryBean</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JaxWsServerFactoryBean</span><span class="o">();</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">setAddress</span><span class="o">(</span><span class="s">"http://localhost:8080/ws/user"</span><span class="o">);</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">setServiceClass</span><span class="o">(</span><span class="nc">UserWS</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">setServiceBean</span><span class="o">(</span><span class="k">new</span> <span class="nc">UserWSImpl</span><span class="o">());</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"soap ws is published"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>è®¿é—®<code class="highlighter-rouge">http://localhost:8080/ws/user?wsdl</code></p>

<h4 id="webå‘å¸ƒ">â‘¡Webå‘å¸ƒ</h4>

<p>é…ç½®ä¾èµ–</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
        <span class="nt">&lt;spring.version&gt;</span>4.0.5.RELEASE<span class="nt">&lt;/spring.version&gt;</span>
        <span class="nt">&lt;cxf.version&gt;</span>3.0.0<span class="nt">&lt;/cxf.version&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>

    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-web<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${spring.version}<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.cxf<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>cxf-rt-frontend-jaxws<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${cxf.version}<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.cxf<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>cxf-rt-transports-http<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${cxf.version}<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
</code></pre></div></div>

<p>é…ç½®web.xml</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;listener&gt;</span>
     <span class="nt">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="nt">&lt;/listener-class&gt;</span>
 <span class="nt">&lt;/listener&gt;</span>
 <span class="nt">&lt;context-param&gt;</span>
     <span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
     <span class="nt">&lt;param-value&gt;</span>
         classpath:spring.xml
     <span class="nt">&lt;/param-value&gt;</span>
 <span class="nt">&lt;/context-param&gt;</span>

 <span class="nt">&lt;servlet&gt;</span>
     <span class="nt">&lt;servlet-name&gt;</span>cxf<span class="nt">&lt;/servlet-name&gt;</span>
     <span class="nt">&lt;servlet-class&gt;</span>org.apache.cxf.transport.servlet.CXFServlet<span class="nt">&lt;/servlet-class&gt;</span>
 <span class="nt">&lt;/servlet&gt;</span>
 <span class="nt">&lt;servlet-mapping&gt;</span>
     <span class="nt">&lt;servlet-name&gt;</span>cxf<span class="nt">&lt;/servlet-name&gt;</span>
     <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
 <span class="nt">&lt;/servlet-mapping&gt;</span>
</code></pre></div></div>

<p>å‘å¸ƒ</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xmlns:context=</span><span class="s">"http://www.springframework.org/schema/context"</span>
       <span class="na">xmlns:jaxws=</span><span class="s">"http://cxf.apache.org/jaxws"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd
       http://cxf.apache.org/jaxws
       http://cxf.apache.org/schemas/jaxws.xsd"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">"top.rainynight.sitews.user.ws"</span> <span class="nt">/&gt;</span>

    <span class="c">&lt;!-- ä¸‹é¢çš„æ–¹æ³•æ›´ç®€å•
    &lt;jaxws:server address="/ws/user"&gt;
        &lt;jaxws:serviceBean&gt;
            &lt;ref bean="userWS"/&gt;
        &lt;/jaxws:serviceBean&gt;
    &lt;/jaxws:server&gt;
    --&gt;</span>

    <span class="nt">&lt;jaxws:endpoint</span> <span class="na">implementor=</span><span class="s">"# userWS"</span> <span class="na">address=</span><span class="s">"/ws/user"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</code></pre></div></div>

<p>è®¿é—®<code class="highlighter-rouge">http://localhost:8080/ws/user?wsdl</code></p>

<h3 id="è°ƒç”¨æœåŠ¡">è°ƒç”¨æœåŠ¡</h3>

<h4 id="é™æ€å®¢æˆ·ç«¯-1">â‘ é™æ€å®¢æˆ·ç«¯</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JaxWsClient</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">JaxWsProxyFactoryBean</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JaxWsProxyFactoryBean</span><span class="o">();</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">setAddress</span><span class="o">(</span><span class="s">"http://localhost:8080/ws/user"</span><span class="o">);</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">setServiceClass</span><span class="o">(</span><span class="nc">UserWS</span> <span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="nc">UserWS</span> <span class="n">userWS</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="nc">UserWS</span> <span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="nc">User</span> <span class="n">result</span> <span class="o">=</span> <span class="n">userWS</span> <span class="o">.</span><span class="na">lookOver</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯-1">â‘¡åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JaxWsDynamicClient</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">JaxWsDynamicClientFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="nc">JaxWsDynamicClientFactory</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
        <span class="nc">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">createClient</span><span class="o">(</span><span class="s">"http://localhost:8080/ws/user?wsdl"</span><span class="o">);</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Object</span><span class="o">[]</span> <span class="n">results</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="s">"lookOver"</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">results</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="é€šç”¨åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯">â‘¢é€šç”¨åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯</h4>

<p>æ—¢å¯è°ƒç”¨ JAX-WS æœåŠ¡ï¼Œä¹Ÿå¯è°ƒç”¨ Simple æœåŠ¡</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DynamicClient</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">DynamicClientFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="nc">DynamicClientFactory</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
        <span class="nc">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">createClient</span><span class="o">(</span><span class="s">"http://localhost:8080/ws/user?wsdl"</span><span class="o">);</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Object</span><span class="o">[]</span> <span class="n">results</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="s">"lookOver"</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">results</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="springå®¢æˆ·ç«¯">â‘£Springå®¢æˆ·ç«¯</h4>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xmlns:jaxws=</span><span class="s">"http://cxf.apache.org/jaxws"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
       http://cxf.apache.org/jaxws
       http://cxf.apache.org/schemas/jaxws.xsd"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;jaxws:client</span> <span class="na">id=</span><span class="s">"userWSClient"</span>
                  <span class="na">serviceClass=</span><span class="s">"top.rainynight.sitews.user.ws.UserWS"</span>
                  <span class="na">address=</span><span class="s">"http://localhost:8080/ws/user"</span><span class="nt">/&gt;</span>

<span class="nt">&lt;/beans&gt;</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserWSClient</span><span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">"spring-client.xml"</span><span class="o">);</span>

        <span class="nc">UserWS</span> <span class="n">userWS</span><span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">"userWSClient"</span><span class="o">,</span> <span class="nc">UserWS</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="nc">User</span> <span class="n">result</span> <span class="o">=</span> <span class="n">userWS</span><span class="o">.</span><span class="na">lookOver</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="2resté£æ ¼"><code class="highlighter-rouge">2</code>.RESTé£æ ¼</h2>

<h3 id="å®šä¹‰æ¥å£-2">å®šä¹‰æ¥å£</h3>

<p><code class="highlighter-rouge">!</code>REST è§„èŒƒå…è®¸èµ„æºç±»æ²¡æœ‰æ¥å£</p>

<blockquote>
  <p>è¯·æ±‚æ–¹å¼æ³¨è§£ï¼ŒåŒ…æ‹¬ï¼š<code class="highlighter-rouge">@GETã€@POSTã€@PUTã€@DELETE</code></p>

  <p>è¯·æ±‚è·¯å¾„æ³¨è§£ï¼ŒåŒ…æ‹¬ï¼š<code class="highlighter-rouge">@Path</code> ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªè·¯å¾„å‚æ•°</p>

  <p>æ•°æ®æ ¼å¼æ³¨è§£ï¼ŒåŒ…æ‹¬ï¼š<code class="highlighter-rouge">@Consumes</code>ï¼ˆè¾“å…¥ï¼‰ã€<code class="highlighter-rouge">@Produces</code>ï¼ˆè¾“å‡ºï¼‰ï¼Œå¯ä½¿ç”¨ <code class="highlighter-rouge">MediaType</code> å¸¸é‡</p>

  <p>ç›¸å…³å‚æ•°æ³¨è§£ï¼ŒåŒ…æ‹¬ï¼š<code class="highlighter-rouge">@PathParam</code>ï¼ˆè·¯å¾„å‚æ•°ï¼‰ã€<code class="highlighter-rouge">@FormParam</code>ï¼ˆè¡¨å•å‚æ•°ï¼‰ï¼Œæ­¤å¤–è¿˜æœ‰ <code class="highlighter-rouge">@QueryParam</code>ï¼ˆè¯·æ±‚å‚æ•°ï¼‰</p>
</blockquote>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">top</span><span class="o">.</span><span class="na">rainynight</span><span class="o">.</span><span class="na">sitews</span><span class="o">.</span><span class="na">user</span><span class="o">.</span><span class="na">ws</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">top.rainynight.sitews.user.entity.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.jws.WebService</span><span class="o">;</span>

<span class="nd">@WebService</span>
<span class="nd">@Path</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserWS</span> <span class="o">{</span>

    <span class="nd">@GET</span>
    <span class="nd">@Path</span><span class="o">(</span><span class="s">"{id:[1-9]{1,9}}"</span><span class="o">)</span>
    <span class="nd">@Produces</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
    <span class="nc">User</span> <span class="nf">lookOver</span><span class="o">(</span><span class="nd">@PathParam</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="å®ç°æ¥å£-2">å®ç°æ¥å£</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">top</span><span class="o">.</span><span class="na">rainynight</span><span class="o">.</span><span class="na">sitews</span><span class="o">.</span><span class="na">user</span><span class="o">.</span><span class="na">ws</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">top.rainynight.sitews.user.entity.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>

<span class="nd">@Component</span><span class="o">(</span><span class="s">"userWS"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserWSImpl</span> <span class="kd">implements</span> <span class="nc">UserWS</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">lookOver</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">User</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="å‘å¸ƒæœåŠ¡-2">å‘å¸ƒæœåŠ¡</h3>

<h4 id="jettyå‘å¸ƒ-1">â‘ jettyå‘å¸ƒ</h4>

<p>é…ç½®ä¾èµ–</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;properties&gt;</span>
    <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
    <span class="nt">&lt;cxf.version&gt;</span>3.0.0<span class="nt">&lt;/cxf.version&gt;</span>
    <span class="nt">&lt;jackson.version&gt;</span>2.4.1<span class="nt">&lt;/jackson.version&gt;</span>
<span class="nt">&lt;/properties&gt;</span>

<span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.apache.cxf<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>cxf-rt-frontend-jaxrs<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>${cxf.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.apache.cxf<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>cxf-rt-transports-http-jetty<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>${cxf.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.jaxrs<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>jackson-jaxrs-json-provider<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>${jackson.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
</code></pre></div></div>

<p>å‘å¸ƒ</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Server</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// æ·»åŠ  ResourceClass</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Class</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">resourceClassList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Class</span><span class="o">&lt;?&gt;&gt;();</span>
        <span class="n">resourceClassList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">UserWSImpl</span> <span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="c1">// æ·»åŠ  ResourceProvider</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ResourceProvider</span><span class="o">&gt;</span> <span class="n">resourceProviderList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">ResourceProvider</span><span class="o">&gt;();</span>
        <span class="n">resourceProviderList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">SingletonResourceProvider</span><span class="o">(</span><span class="k">new</span> <span class="nc">ProductServiceImpl</span><span class="o">()));</span>

        <span class="c1">// æ·»åŠ  Provider</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">providerList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;();</span>
        <span class="n">providerList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">JacksonJsonProvider</span><span class="o">());</span>

        <span class="c1">// å‘å¸ƒ REST æœåŠ¡</span>
        <span class="nc">JAXRSServerFactoryBean</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JAXRSServerFactoryBean</span><span class="o">();</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">setAddress</span><span class="o">(</span><span class="s">"http://localhost:8080/rs/user"</span><span class="o">);</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">setResourceClasses</span><span class="o">(</span><span class="n">resourceClassList</span><span class="o">);</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">setResourceProviders</span><span class="o">(</span><span class="n">resourceProviderList</span><span class="o">);</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">setProviders</span><span class="o">(</span><span class="n">providerList</span><span class="o">);</span>
        <span class="n">factory</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"rest ws is published"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>è®¿é—®<code class="highlighter-rouge">http://localhost:8080/rs/user?_wadl</code></p>

<h4 id="webå‘å¸ƒ-1">â‘¡webå‘å¸ƒ</h4>

<p>é…ç½®ä¾èµ–</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
        <span class="nt">&lt;spring.version&gt;</span>4.0.6.RELEASE<span class="nt">&lt;/spring.version&gt;</span>
        <span class="nt">&lt;cxf.version&gt;</span>3.0.0<span class="nt">&lt;/cxf.version&gt;</span>
        <span class="nt">&lt;jackson.version&gt;</span>2.4.1<span class="nt">&lt;/jackson.version&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>

    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-web<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${spring.version}<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.cxf<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>cxf-rt-frontend-jaxrs<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${cxf.version}<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.jaxrs<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>jackson-jaxrs-json-provider<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${jackson.version}<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
</code></pre></div></div>

<p>é…ç½®web.xml</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;listener&gt;</span>
     <span class="nt">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="nt">&lt;/listener-class&gt;</span>
 <span class="nt">&lt;/listener&gt;</span>
 <span class="nt">&lt;context-param&gt;</span>
     <span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
     <span class="nt">&lt;param-value&gt;</span>
         classpath:spring.xml
     <span class="nt">&lt;/param-value&gt;</span>
 <span class="nt">&lt;/context-param&gt;</span>

 <span class="nt">&lt;servlet&gt;</span>
     <span class="nt">&lt;servlet-name&gt;</span>cxf<span class="nt">&lt;/servlet-name&gt;</span>
     <span class="nt">&lt;servlet-class&gt;</span>org.apache.cxf.transport.servlet.CXFServlet<span class="nt">&lt;/servlet-class&gt;</span>
 <span class="nt">&lt;/servlet&gt;</span>
 <span class="nt">&lt;servlet-mapping&gt;</span>
     <span class="nt">&lt;servlet-name&gt;</span>cxf<span class="nt">&lt;/servlet-name&gt;</span>
     <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
 <span class="nt">&lt;/servlet-mapping&gt;</span>
</code></pre></div></div>

<p>å‘å¸ƒ</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>

<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xmlns:context=</span><span class="s">"http://www.springframework.org/schema/context"</span>
       <span class="na">xmlns:jaxrs=</span><span class="s">"http://cxf.apache.org/jaxrs"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd
       http://cxf.apache.org/jaxrs
       http://cxf.apache.org/schemas/jaxrs.xsd"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">"top.rainynight.sitews.user.ws"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;jaxrs:server</span> <span class="na">address=</span><span class="s">"/rs/user"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;jaxrs:serviceBeans&gt;</span>
            <span class="nt">&lt;ref</span> <span class="na">bean=</span><span class="s">"userWS"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/jaxrs:serviceBeans&gt;</span>
        <span class="nt">&lt;jaxrs:providers&gt;</span>
            <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/jaxrs:providers&gt;</span>
    <span class="nt">&lt;/jaxrs:server&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</code></pre></div></div>

<p>è®¿é—®<code class="highlighter-rouge">http://localhost:8080/rs/user?_wadl</code></p>

<h3 id="è°ƒç”¨æœåŠ¡-1">è°ƒç”¨æœåŠ¡</h3>

<h4 id="jax-rs-10-å®¢æˆ·ç«¯">â‘ JAX-RS 1.0 å®¢æˆ·ç«¯</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JAXRSClient</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">baseAddress</span> <span class="o">=</span> <span class="s">"http://localhost:8080/rs/user"</span><span class="o">;</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">providerList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;();</span>
        <span class="n">providerList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">JacksonJsonProvider</span><span class="o">());</span>

        <span class="nc">UserWS</span> <span class="n">userWS</span> <span class="o">=</span> <span class="nc">JAXRSClientFactory</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">baseAddress</span><span class="o">,</span> <span class="nc">UserWS</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">providerList</span><span class="o">);</span>

    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="jax-rs-20-å®¢æˆ·ç«¯">â‘¡JAX-RS 2.0 å®¢æˆ·ç«¯</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JAXRS20Client</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">baseAddress</span> <span class="o">=</span> <span class="s">"http://localhost:8080/rs/user"</span><span class="o">;</span>

        <span class="nc">JacksonJsonProvider</span> <span class="n">jsonProvider</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JacksonJsonProvider</span><span class="o">();</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">userList</span> <span class="o">=</span> <span class="nc">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">()</span>
            <span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">jsonProvider</span><span class="o">)</span>
            <span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="n">baseAddress</span><span class="o">)</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">"/1"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
            <span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="k">new</span> <span class="nc">GenericType</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;&gt;()</span> <span class="o">{});</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="webclient-å®¢æˆ·ç«¯">â‘¢WebClient å®¢æˆ·ç«¯</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CXFWebClient</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">baseAddress</span> <span class="o">=</span> <span class="s">"http://localhost:8080/rs/user"</span><span class="o">;</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">providerList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">&gt;();</span>
        <span class="n">providerList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">JacksonJsonProvider</span><span class="o">());</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">userList</span> <span class="o">=</span> <span class="nc">WebClient</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">baseAddress</span><span class="o">,</span> <span class="n">providerList</span><span class="o">)</span>
            <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">"/1"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
            <span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="k">new</span> <span class="nc">GenericType</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;&gt;()</span> <span class="o">{});</span>

    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="ajaxå®¢æˆ·ç«¯">â‘£AJAXå®¢æˆ·ç«¯</h4>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
  <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">get</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">url</span><span class="p">:</span> <span class="dl">'</span><span class="s1">http://localhost:8080/rs/user/1</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">dataType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">json</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">//...</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>è·¨åŸŸæ–¹æ¡ˆ1ï¼šjsonp</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.cxf<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>cxf-rt-rs-extension-providers<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${cxf.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;jaxrs:server</span> <span class="na">address=</span><span class="s">"/rs/user"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;jaxrs:serviceBeans&gt;</span>
        <span class="nt">&lt;ref</span> <span class="na">bean=</span><span class="s">"userWS"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/jaxrs:serviceBeans&gt;</span>
    <span class="nt">&lt;jaxrs:providers&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.apache.cxf.jaxrs.provider.jsonp.JsonpPreStreamInterceptor"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/jaxrs:providers&gt;</span>
    <span class="nt">&lt;jaxrs:inInterceptors&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.apache.cxf.jaxrs.provider.jsonp.JsonpInInterceptor"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/jaxrs:inInterceptors&gt;</span>
    <span class="nt">&lt;jaxrs:outInterceptors&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.apache.cxf.jaxrs.provider.jsonp.JsonpPostStreamInterceptor"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/jaxrs:outInterceptors&gt;</span>
<span class="nt">&lt;/jaxrs:server&gt;</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">get</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="dl">'</span><span class="s1">http://localhost:8080/rs/user/1</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">jsonp</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">jsonp</span><span class="p">:</span> <span class="dl">'</span><span class="s1">_jsonp</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">jsonpCallback</span><span class="p">:</span> <span class="dl">'</span><span class="s1">callback</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//...</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>è·¨åŸŸæ–¹æ¡ˆ2ï¼šcors</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.cxf<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>cxf-rt-rs-security-cors<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${cxf.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;jaxrs:server</span> <span class="na">address=</span><span class="s">"/rs/user"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;jaxrs:serviceBeans&gt;</span>
        <span class="nt">&lt;ref</span> <span class="na">bean=</span><span class="s">"userWS"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/jaxrs:serviceBeans&gt;</span>
    <span class="nt">&lt;jaxrs:providers&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.apache.cxf.rs.security.cors.CrossOriginResourceSharingFilter"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"allowOrigins"</span> <span class="na">value=</span><span class="s">"http://localhost"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/jaxrs:providers&gt;</span>
<span class="nt">&lt;/jaxrs:server&gt;</span>
</code></pre></div></div>

<p>allowOrigins è®¾ç½®å®¢æˆ·ç«¯åŸŸå</p>

<p>IE8 ä¸­ä½¿ç”¨ jQuery å‘é€ AJAX è¯·æ±‚æ—¶ï¼Œéœ€è¦é…ç½® <code class="highlighter-rouge">$.support.cors = true</code></p>

<h2 id="è­¦å‘Š"><code class="highlighter-rouge">ï½ï½</code>è­¦å‘Š<code class="highlighter-rouge">ï½ï½</code></h2>
<p><code class="highlighter-rouge">!warning</code> æé‡è¦ï¼Œcxfåœ¨wsdlä¸­å‘å¸ƒçš„<code class="highlighter-rouge">targetNamespace</code>æ˜¯å®ç°ç±»è·¯å¾„ï¼Œè€Œè¢«è°ƒç”¨æ—¶å´åªæ¥å—æ¥å£è·¯å¾„ã€‚æ‰€ä»¥ï¼Œè¯·å°†æ¥å£ä¸å®ç°ç±»æ”¾åœ¨åŒä¸€è·¯å¾„ä¸‹ï¼Œæˆ–è€…åœ¨å®ç°ç±»ä¸­æŒ‡å®š<code class="highlighter-rouge">targetNamespace</code>ä¸ºæ¥å£çš„è·¯å¾„ï¼›å¦åˆ™å®¢æˆ·ç«¯å°†æŠ›å‡º ..common.i18n.UncheckedException: No operation was found with the name â€¦ å¼‚å¸¸</p>
:ET